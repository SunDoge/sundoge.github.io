<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ä½¿ç”¨ Hexo æ­å»ºä¸ªäººåšå®¢</title>
    <url>/2019/09/14/%E4%BD%BF%E7%94%A8Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
    <content><![CDATA[<h2 id="å®‰è£…Node-jså’ŒHexo"><a href="#å®‰è£…Node-jså’ŒHexo" class="headerlink" title="å®‰è£…Node.jså’ŒHexo"></a>å®‰è£… Node.js å’Œ Hexo</h2><p>å‚ç…§ Hexo å®˜ç½‘æ•™ç¨‹ <a href="https://hexo.io/docs/#Install-Node-js">https://hexo.io/docs/#Install-Node-js</a></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh | bash</span><br><span class="line">nvm install stable</span><br><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></tbody></table></figure>
<h2 id="åˆ›å»ºä½ çš„åšå®¢"><a href="#åˆ›å»ºä½ çš„åšå®¢" class="headerlink" title="åˆ›å»ºä½ çš„åšå®¢"></a>åˆ›å»ºä½ çš„åšå®¢</h2><p>å‚ç…§ <a href="https://hexo.io/docs/setup">https://hexo.io/docs/setup</a></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo init sundoge.github.io</span><br></pre></td></tr></tbody></table></figure>
<p>æˆ‘ä½¿ç”¨çš„ <code>hexo-cli</code> ç‰ˆæœ¬ä¸º <code>2.0.0</code> ï¼Œä¼šè‡ªåŠ¨æ‹‰å–é»˜è®¤ä¸»é¢˜ <code>landscape</code> ã€‚åé¢å°†å¼•å…¥ <a href="https://github.com/theme-next/hexo-theme-next">hexo-theme-next</a> ã€‚</p>
<h2 id="ä½¿ç”¨Gitç®¡ç†ä½ çš„åšå®¢"><a href="#ä½¿ç”¨Gitç®¡ç†ä½ çš„åšå®¢" class="headerlink" title="ä½¿ç”¨Gitç®¡ç†ä½ çš„åšå®¢"></a>ä½¿ç”¨ Git ç®¡ç†ä½ çš„åšå®¢</h2><p>Hexo çš„è®¾è®¡æœ‰ä¸ªçŸ›ç›¾çš„åœ°æ–¹ï¼Œtheme æœ‰è‡ªå·±çš„ config æ–‡ä»¶ï¼Œè€Œä¸”ä¸ä¼š merge åˆ°é¡¶å±‚çš„ configï¼Œå¯¼è‡´ä½ å¾ˆéš¾ç”¨ git ç®¡ç†ä½ çš„ themeã€‚å¦‚æœä½ æŒ‰ç…§ theme-next çš„å®˜æ–¹æ–‡æ¡£ installï¼Œå°±ç›¸å½“äºåœ¨ git ä»“åº“é‡Œé¢åˆ›å»ºå¦ git ä»“åº“ï¼Œgit æ˜¯æ²¡æ³•ç®¡ç†åˆ°ä»“åº“é‡Œé¢çš„ä»“åº“çš„ã€‚ä½†æ˜¯å¦‚æœå•çº¯ä½¿ç”¨ git submoduleï¼Œä¿®æ”¹ theme é‡Œé¢çš„_config.yml ä¹Ÿæ˜¯æ²¡æ³•ç”¨ git ç®¡ç†çš„ã€‚æ‰€ä»¥ä¸€ä¸ªæŠ˜ä¸­çš„æ–¹æ¡ˆæ˜¯ï¼Œå…ˆ fork ä¸€ä»½ä½ è¦çš„ä¸»é¢˜ï¼Œæ¯”å¦‚ <a href="https://github.com/SunDoge/hexo-theme-next">SunDoge/hexo-theme-next</a> ï¼Œç„¶å add submodule</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">git submodule add git@github.com:SunDoge/hexo-theme-next.git themes/next</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™æ · theme å’Œåšå®¢éƒ½èƒ½è¢«ç®¡ç†åˆ°ã€‚å¦‚æœéœ€è¦æ›´æ–° themeï¼Œåªéœ€è¦è¿è¡Œ</p>
<blockquote>
<p><a href="https://stackoverflow.com/questions/5828324/update-git-submodule-to-latest-commit-on-origin">https://stackoverflow.com/questions/5828324/update-git-submodule-to-latest-commit-on-origin</a></p>
</blockquote>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">git submodule foreach git pull origin master</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™ä¸ªå‘½ä»¤ä¼šæ›´æ–°æ‰€æœ‰çš„ submoduleã€‚</p>
<h2 id="ä½¿ç”¨theme-next"><a href="#ä½¿ç”¨theme-next" class="headerlink" title="ä½¿ç”¨theme-next"></a>ä½¿ç”¨ theme-next</h2><p>ä¿®æ”¹é¡¶å±‚<code>_config.yml</code></p>
<figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="comment"># theme: landscape</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">next</span></span><br></pre></td></tr></tbody></table></figure>
<p>ä¿®æ”¹ theme é‡Œé¢çš„_config.yml</p>
<blockquote>
<p> themes/next/_config.yml</p>
</blockquote>
<figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># Schemes</span></span><br><span class="line"><span class="comment"># scheme: Muse</span></span><br><span class="line"><span class="attr">scheme:</span> <span class="string">Mist</span></span><br><span class="line"><span class="comment">#scheme: Pisces</span></span><br><span class="line"><span class="comment">#scheme: Gemini</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="å¼€å¯mathæ”¯æŒ"><a href="#å¼€å¯mathæ”¯æŒ" class="headerlink" title="å¼€å¯mathæ”¯æŒ"></a>å¼€å¯ math æ”¯æŒ</h3><blockquote>
<p><a href="https://github.com/theme-next/hexo-theme-next/blob/master/docs/MATH.md">https://github.com/theme-next/hexo-theme-next/blob/master/docs/MATH.md</a></p>
</blockquote>
<figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># Math Formulas Render Support</span></span><br><span class="line"><span class="attr">math:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Default (true) will load mathjax / katex script on demand.</span></span><br><span class="line">  <span class="comment"># That is it only render those page which has `mathjax: true` in Front-matter.</span></span><br><span class="line">  <span class="comment"># If you set it to false, it will load mathjax / katex srcipt EVERY PAGE.</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># hexo-renderer-pandoc (or hexo-renderer-kramed) required for full MathJax support.</span></span><br><span class="line">  <span class="attr">mathjax:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># See: https://mhchem.github.io/MathJax-mhchem/</span></span><br><span class="line">    <span class="attr">mhchem:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># hexo-renderer-markdown-it-plus (or hexo-renderer-markdown-it with markdown-it-katex plugin) required for full Katex support.</span></span><br><span class="line">  <span class="attr">katex:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># See: https://github.com/KaTeX/KaTeX/tree/master/contrib/copy-tex</span></span><br><span class="line">    <span class="attr">copy_tex:</span> <span class="literal">false</span></span><br></pre></td></tr></tbody></table></figure>
<p>æˆ‘æš‚æ—¶ä½¿ç”¨ mathjaxï¼Œå¦‚æœå®åœ¨å¤ªæ…¢ï¼Œåé¢å†æ¢æˆ katexã€‚è¿™é‡Œè¿˜éœ€è¦æ›¿æ¢é»˜è®¤çš„ renderã€‚</p>
<figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">npm un hexo-renderer-marked --save</span><br><span class="line">npm i hexo-renderer-pandoc --save # or hexo-renderer-kramed</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™é‡Œä¸ç”¨ kramed çš„åŸå› æ˜¯å®ƒæœ€åä¸€æ¬¡æ›´æ–°åœ¨ 2017 å¹´ã€‚è¿˜éœ€è¦å®‰è£… pandoc</p>
<blockquote>
<p><a href="https://github.com/jgm/pandoc/blob/master/INSTALL.md">https://github.com/jgm/pandoc/blob/master/INSTALL.md</a></p>
</blockquote>
<p>å®‰è£… pandoc è¿™ç‚¹è®©æˆ‘å¾ˆä¸æ»¡æ„ï¼Œä½¿ç”¨ Hexo å·²ç»è¦å®‰è£…å¾ˆå¤šä¸œè¥¿äº†ï¼ˆnode_modulesï¼‰ï¼Œä¸ºäº† mathjax è¿˜è¦æ•´ä¸ª pandocã€‚</p>
<h2 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h2><blockquote>
<p><a href="https://hexo.io/docs/deployment.html#Git">https://hexo.io/docs/deployment.html#Git</a></p>
</blockquote>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">    <span class="attr">repo:</span> <span class="string">git@github.com:SunDoge/sundoge.github.io.git</span></span><br><span class="line">    <span class="attr">branch:</span> <span class="string">published</span></span><br></pre></td></tr></tbody></table></figure>
<p>ç„¶ååœ¨ github ä¸Šæ–°å»ºä¸€ä¸ª branch åä¸º published</p>
<blockquote>
<p><a href="https://help.github.com/en/articles/creating-and-deleting-branches-within-your-repository">https://help.github.com/en/articles/creating-and-deleting-branches-within-your-repository</a></p>
</blockquote>
<p>å¹¶æŠŠå®ƒè®¾ä¸º default branchã€‚ç„¶åæ‰§è¡Œ</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo deploy</span><br></pre></td></tr></tbody></table></figure>
<p>ç¼–è¯‘å¥½çš„æ–‡ä»¶ä¼šæ¨é€çš„ published åˆ†æ”¯ã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆä½¿ç”¨Hexo"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨Hexo" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨Hexo"></a>ä¸ºä»€ä¹ˆä½¿ç”¨ Hexo</h2><p>Hugo è™½ç„¶æ€§èƒ½å¥½ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†ä¸»é¢˜å¹´ä¹…å¤±ä¿®ï¼Œè€Œä¸”è´¨é‡éƒ½ä¸é«˜ï¼Œä» jekyll å’Œ hexo ç§»æ¤çš„ä¸»é¢˜ä¹Ÿå¤§å¤šæœ‰é—®é¢˜ï¼Œç¼ºå°‘åŸæœ‰çš„éƒ¨åˆ†åŠŸèƒ½ã€‚æœ€åæ²¡åŠæ³•ï¼Œè¿˜æ˜¯è¦ç”¨å‰ç«¯å†™çš„å·¥å…·ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿ä»¥åçš„å†™ä½œï¼Œæˆ‘è®¡åˆ’ä½¿ç”¨ Rust å¼€å‘ä¸€ä¸ª hexo-cli çš„å­é›†ï¼Œåªæ”¯æŒ theme-next çš„æ­£ç¡®ç¼–è¯‘ğŸ•ŠğŸ•ŠğŸ•Šâ€‹ã€‚</p>
]]></content>
      <tags>
        <tag>Hexo</tag>
        <tag>Node.js</tag>
      </tags>
  </entry>
  <entry>
    <title>åœ¨ Hyper-V ä¸Šå®‰è£… manjaro</title>
    <url>/2019/09/15/%E5%9C%A8Hyper-V%E4%B8%8A%E5%AE%89%E8%A3%85manjaro/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://forum.manjaro.org/t/how-to-run-manjaro-on-windows-10-hyper-v-gen2/54092/20">https://forum.manjaro.org/t/how-to-run-manjaro-on-windows-10-hyper-v-gen2/54092/20</a></p>
</blockquote>
<p><img src="https://i.loli.net/2019/09/15/PFraGJk26T1WjVC.png" alt="xrdp"></p>
<p><a href="https://forum.manjaro.org/t/installing-manjaro-in-hyper-v-with-enhanced-session-support/79394">https://forum.manjaro.org/t/installing-manjaro-in-hyper-v-with-enhanced-session-support/79394</a></p>
]]></content>
      <tags>
        <tag>Manjaro</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>å†™ä½œæ–¹å‘è°ƒæ•´</title>
    <url>/2020/07/29/%E5%86%99%E4%BD%9C%E6%96%B9%E5%90%91%E8%B0%83%E6%95%B4/</url>
    <content><![CDATA[<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><p>æ­¤æ¬¡æ›´æ–°äº† post çš„å‘½åæ ¼å¼ã€‚</p>
<h2 id="æ–¹å‘è°ƒæ•´"><a href="#æ–¹å‘è°ƒæ•´" class="headerlink" title="æ–¹å‘è°ƒæ•´"></a>æ–¹å‘è°ƒæ•´</h2><p>èµµç¥é’¦å®šï¼Œè¿™ä¸ªåšå®¢ä»¥ååªå†™èµµç¥ä¸ä¼šçš„ä¸œè¥¿ã€‚</p>
]]></content>
      <tags>
        <tag>Announcement</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ theme_config ç®¡ç†ä½ çš„ Hexo theme</title>
    <url>/2020/07/31/%E4%BD%BF%E7%94%A8theme-config%E7%AE%A1%E7%90%86%E4%BD%A0%E7%9A%84Hexo-theme/</url>
    <content><![CDATA[<p>è‡ª Hexo 2.8.2 ä¹‹å <a href="https://hexo.io/docs/configuration">[1]</a>ï¼ŒHexo æ”¯æŒä½¿ç”¨ <code>theme_config</code> æ¥é…ç½® themeã€‚åœ¨è¿™ä¹‹å‰ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ä½¿ç”¨ git æ¥æ›´æ–°æˆ‘ä»¬ themeï¼ŒåŒæ—¶åˆæƒ³ç”¨ git ç®¡ç† theme çš„ configï¼Œæˆ‘æ‰€çŸ¥é“çš„å”¯ä¸€ä¸€ä¸ªåŠæ³•ï¼Œå°±æ˜¯ fork ä¸€ä»½ themeï¼Œä¿®æ”¹å…¶ä¸­çš„<code>_config.yml</code>ï¼Œå†ç”¨ <code>git submodule</code> å°† fork çš„ theme å¼•å…¥åšå®¢ä»“åº“ä¸­ã€‚è¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒç¹çã€‚</p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨åšå®¢ä»“åº“ä¸‹çš„<code>_config.yml</code> æ¥è¦†ç›– theme ä»“åº“ä¸‹çš„ configã€‚ä»¥æˆ‘ä½¿ç”¨çš„ NexT ä¸ºä¾‹ï¼Œé»˜è®¤çš„ Muse scheme å¹¶ä¸å’Œæˆ‘æ„ï¼Œæˆ‘å¸Œæœ›å°†å…¶ä¿®æ”¹æˆ Mist schemeï¼Œåªéœ€è¦æ·»åŠ å‡ è¡Œé…ç½®ï¼š</p>
<figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">theme_config:</span></span><br><span class="line">  <span class="attr">scheme:</span> <span class="string">Mist</span></span><br></pre></td></tr></tbody></table></figure>
<p>Hexo 5.0.0 ä¹‹å <a href="https://hexo.io/docs/configuration">[1]</a>ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä¸ºæ¯ä¸ª theme åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ config æ–‡ä»¶æ¥è¿›è¡Œç®¡ç†ï¼Œæ–‡ä»¶å‘½åè§„åˆ™ä¸º<code>_config.[theme].yml</code>ã€‚è¿˜æ˜¯ä»¥ NexT ä¸ºä¾‹ï¼Œåˆ›å»º<code>_config.next.yml</code>ï¼Œä¿®æ”¹å†…å®¹ä¸ºï¼š</p>
<figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">scheme:</span> <span class="string">Mist</span></span><br></pre></td></tr></tbody></table></figure>
<p>theme å°±é…ç½®å¥½äº†ã€‚</p>
<p>å¾ˆå¥‡æ€ªçš„ä¸€ç‚¹æ˜¯ï¼Œç›®å‰å¾ˆå¤šå…³äº theme çš„èµ„æ–™éƒ½æ²¡æœ‰æåˆ° Hexo å·²ç»æ”¯æŒè¦†ç›– theme configï¼Œå¯¼è‡´æˆ‘ä½¿ç”¨äº†å¾ˆé•¿ä¸€æ®µæ—¶é—´çš„ Hexo 3.9ï¼Œå´è¿˜æ˜¯åœ¨ç”¨ fork+submodule çš„æ–¹æ³•æ¥ç®¡ç† themeã€‚</p>
<p>ä¸‹æ¬¡æˆ‘å°†å°è¯•ä½¿ç”¨ github action æ¥è‡ªåŠ¨ deploy æˆ‘çš„åšå®¢ã€‚</p>
<hr>
<p>2020-07-31 Update</p>
<p>Hexo 5.0.0 æ”¯æŒä½¿ç”¨ npm é…ç½® theme äº†ã€‚ä»¥åä¸éœ€è¦æ‰‹åŠ¨ç®¡ç†ç‰ˆæœ¬ï¼Œåªéœ€è¦</p>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">npm i hexo-theme-next --save</span><br></pre></td></tr></tbody></table></figure>
<p>ç›®å‰é€šè¿‡ npm å®‰è£…çš„ä¸»é¢˜åœ¨æ‰§è¡Œ hexo clean æ—¶ä¼šæŠ¥é”™ï¼Œæ˜¯ Hexo çš„å·²çŸ¥é—®é¢˜ï¼Œå°†åœ¨ä¸‹ä¸ªç‰ˆæœ¬ä¿®å¤ã€‚</p>
]]></content>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>TensorFlow Datasets: The Bad Parts</title>
    <url>/2020/08/02/TensorFlow-Datasets-The-Bad-Parts/</url>
    <content><![CDATA[<p>æœ¬æ–‡æ˜¯ <a href="https://determined.ai/blog/tf-dataset-the-bad-parts/">https://determined.ai/blog/tf-dataset-the-bad-parts/</a> çš„è¯‘æ–‡ã€‚æˆ‘åœ¨å°è¯•ç”¨ TensorFlow å‚ç…§ PyTorch ä»£ç å¤ç°ä¸€äº›æ¨¡å‹çš„æ—¶å€™ä¹Ÿäº§ç”Ÿäº†åŒæ ·çš„æƒ³æ³•ã€‚æœ¬æ–‡ä»…ä¾›ä¸ªäººç ”ç©¶ä½¿ç”¨ã€‚</p>
<hr>
<p><strong>TLDR</strong>: TensorFlow çš„ <code>tf.data</code> API æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„å°†æ•°æ®åŠ è½½è¿›æ·±åº¦æ¨¡å‹çš„æ–¹æ³•ã€‚è™½ç„¶ <code>tf.data</code> æœ‰å¾ˆå¤šå¼ºå¤§çš„åŠŸèƒ½ï¼Œä½†æ˜¯å®ƒæ˜¯å›´ç»•é¡ºåºè¯»å–æ•°æ®é›†è®¾è®¡çš„ã€‚è¿™ä¸ªè®¾è®¡å¯¼è‡´å®ƒæ— æ³•é«˜æ•ˆå®ç°ä¸€äº›åŠŸèƒ½ï¼šshuffle å¤§æ•°æ®é›†ï¼Œåˆ†å¸ƒå¼è®­ç»ƒæ—¶å¯¹æ•°æ®è¿›è¡Œåˆ†ç‰‡ï¼Œå®ç°å®¹é”™è®­ç»ƒï¼ˆfault-tolerant trainingï¼‰ã€‚æˆ‘ä»¬è®¤ä¸ºï¼Œåœ¨æ„å»ºæ·±åº¦å­¦ä¹ æ•°æ®è¯»å– API æ—¶ï¼Œéšæœºè®¿é—®åº”è¯¥æ˜¯éœ€è¦è€ƒè™‘çš„å…³é”®å› ç´ ã€‚</p>
<p>åœ¨æ„å»ºç«¯åˆ°ç«¯çš„ä¼ä¸šæ·±åº¦å­¦ä¹ å¹³å°æ—¶ï¼Œå·¥ç¨‹å›¢é˜Ÿå¯èƒ½ä¼šé‡åˆ°<a href="https://determined.ai/blog/building-an-enterprise-deep-learning-platform/">è®¸å¤šé™·é˜±</a>ã€‚æœ€å¸¸è§çš„é—®é¢˜ä¹‹ä¸€æ¶‰åŠæ•°æ®åŠ è½½ã€‚è®­ç»ƒæœŸé—´çš„æ•°æ®åŠ è½½å¸¸å¸¸è¢«å¿½ç•¥ï¼Œä½†æ˜¯å®ƒå¯èƒ½å¯¹ååé‡äº§ç”Ÿå·¨å¤§å½±å“ã€‚æœºå™¨å­¦ä¹ æ¡†æ¶æä¾›äº†ä¸€äº›æŠ½è±¡ï¼Œè¯•å›¾è®©æ•°æ®åŠ è½½å˜å¾—ç®€å•ç›´æ¥ã€‚ä½†æ˜¯ï¼Œåœ¨çœ‹ä¼¼ç®€å•æ¥å£èƒŒåå¯èƒ½éšè—äº†ä¸€äº›ä»¤äººæƒŠè®¶çš„é—®é¢˜ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å¸¦ä½ äº†è§£ä¸€ä¸ªå¸¸è§çš„æ•°æ®åŠ è½½ APIï¼š<a href="https://www.tensorflow.org/api_docs/python/tf/data/Dataset">TensorFlow Datasets</a>ã€‚</p>
<p><img src="https://i.loli.net/2020/08/02/eKtHoD4mk1CyPsr.png" alt="image.png"></p>
<h2 id="Data-Loader-Patterns"><a href="#Data-Loader-Patterns" class="headerlink" title="Data Loader Patterns"></a>Data Loader Patterns</h2><p>æ•°æ®åŠ è½½æ¥å£å¯ä»¥ä½¿ç”¨ä¸¤ç§åŸºæœ¬æ¨¡å¼ï¼Œ<strong>éšæœºè®¿é—®ï¼ˆrandom accessï¼‰</strong>å’Œ<strong>é¡ºåºè®¿é—®ï¼ˆsequential accessï¼‰</strong>ã€‚</p>
<h3 id="Random-Access"><a href="#Random-Access" class="headerlink" title="Random Access"></a>Random Access</h3><p>éšæœºè®¿é—®æ˜¯æŒ‡é«˜æ•ˆè®¿é—®æ•°æ®é›†ä¸­ä»»ä½•å…ƒç´ çš„èƒ½åŠ›ã€‚åœ¨ Python ä¸­ï¼Œéšæœºè®¿é—®é€šå¸¸é€šè¿‡å¯¹ä¸€ä¸ªåˆ—è¡¨è¿›è¡Œç´¢å¼•æ¥å®Œæˆï¼ˆi.e., <code>data[index]</code>ï¼‰ ï¼ŒèƒŒåå®é™…è°ƒç”¨äº†<code>__getitem__()</code>ã€‚PyTorch ä½¿ç”¨è¿™ç§æ–¹æ³•æ¥å®šä¹‰æ˜ å°„æ ·å¼ï¼ˆmap-styleï¼‰çš„æ•°æ®é›†æ¥å£ï¼ˆä¸Šé¢å®ç°çš„é‚£ç§ï¼‰ã€‚éšæœºè®¿é—®æ•°æ®åŠ è½½å™¨æ¥å£è¿˜å¯èƒ½è¦æ±‚ç”¨æˆ·æŒ‡å®šæ•°æ®é›†çš„æ•´ä¸ªé•¿åº¦ï¼ˆ<code>__len__()</code>ï¼‰ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch.utils.data</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RandomAccessDataset</span>(<span class="params">torch.utils.data.Dataset</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, data: List</span>) -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self.data = data</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span>(<span class="params">self</span>) -&gt; int:</span></span><br><span class="line">        <span class="keyword">return</span> len(self.data)</span><br><span class="line"></span><br><span class="line">    def __getitem__(self, index: int): -&gt; Any:</span><br><span class="line">        <span class="keyword">return</span> self.data[index]</span><br></pre></td></tr></tbody></table></figure>
<p>æ”¯æŒéšæœºè®¿é—®çš„æ·±åº¦å­¦ä¹ æ•°æ® api åŒ…æ‹¬ <code>tfkeras.utils.Sequence</code> å’Œ <code>torch.utils.data.Dataset</code> (Map Style)ã€‚</p>
<h3 id="Sequential-Access"><a href="#Sequential-Access" class="headerlink" title="Sequential Access"></a>Sequential Access</h3><p>é¡ºåºè¯»å–æ˜¯ä¸€ç§å…ƒç´ å¿…é¡»æŒ‰é¢„å®šé¡ºåºè®¿é—®çš„æ¨¡å¼ï¼Œé€šå¸¸æ˜¯é€šè¿‡è¿­ä»£å™¨è®¿é—®ã€‚åœ¨ Python ä¸­ï¼Œé¡ºåºè®¿é—®é€šå¸¸æ˜¯é€šè¿‡è¿­ä»£å™¨å’Œ <code>yield</code> è¡¨è¾¾å¼å®ç°çš„ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sequential_dataset</span>(<span class="params">data: List</span>) -&gt; Iterator:</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">yield</span> item</span><br></pre></td></tr></tbody></table></figure>
<p>ä¸€äº›æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œæ¯”å¦‚æ—©æœŸç‰ˆæœ¬çš„ kerasï¼ŒåŸç”Ÿæ”¯æŒå°†æ•°æ®è¾“å…¥ç®¡é“ï¼ˆdata input pipelineï¼‰è¡¨ç¤ºä¸º Python ç”Ÿæˆå™¨ã€‚ç±»ä¼¼åœ°ï¼ŒTensorFlow Datasets æ˜¯å›´ç»•é¡ºåºæ•°æ®è®¿é—®æ„å»ºçš„ã€‚ Python ç”Ÿæˆå™¨è½¬æ¢ä¸º TensorFlow Dataset éå¸¸ç®€å•ï¼Œè™½ç„¶æœ‰ç‚¹å•°å—¦ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> itertools.count(<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">yield</span> (i, [<span class="number">1</span>] * i)</span><br><span class="line"></span><br><span class="line">dataset = tf.data.Dataset.from_generator(</span><br><span class="line">     gen,</span><br><span class="line">     (tf.int64, tf.int64),</span><br><span class="line">     (tf.TensorShape([]), tf.TensorShape([<span class="literal">None</span>])))</span><br></pre></td></tr></tbody></table></figure>
<p>åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºä½¿ç”¨å¾ªåºè®¿é—®ä½œä¸ºæ•°æ®åŠ è½½å™¨çš„ç¼ºç‚¹ã€‚</p>
<h2 id="Sequential-Access-in-TensorFlow-Datasets"><a href="#Sequential-Access-in-TensorFlow-Datasets" class="headerlink" title="Sequential Access in TensorFlow Datasets"></a>Sequential Access in TensorFlow Datasets</h2><p>TensorFlow çš„ <code>tf.data</code> API ä»¥ä¸€ç§ä¼˜é›…çš„æ–¹å¼ç®€åŒ–äº†æ•°æ®åŠ è½½ä»£ç çš„ç»“æ„ï¼šä½ å¯ä»¥ä½¿ç”¨ lazy initialization çš„æ–¹å¼å°†ä¸€ç³»åˆ—æ“ä½œä¸²èµ·æ¥ã€‚<code>tf.data</code> è¿˜æä¾›äº† helper API æ¥å®Œæˆ<a href="https://www.tensorflow.org/api_docs/python/tf/data/Dataset#prefetch">é¢„è¯»å–</a>å’Œ<a href="https://www.tensorflow.org/guide/data_performance#parallelizing_data_extraction">å¹¶è¡Œæ•°æ®åŠ è½½</a>ç­‰å¸¸è§ä»»åŠ¡ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dataset = tf.data.Dataset.from_tensor_slices([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> dataset:</span><br><span class="line">   <span class="keyword">print</span> (element)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tf.Tensor(<span class="number">1</span>, shape=(), dtype=int32)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tf.Tensor(<span class="number">2</span>, shape=(), dtype=int32)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tf.Tensor(<span class="number">3</span>, shape=(), dtype=int32)</span><br><span class="line"></span><br><span class="line">dataset = dataset.map(<span class="keyword">lambda</span> x: x*<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> dataset:</span><br><span class="line">   <span class="keyword">print</span> (element)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tf.Tensor(<span class="number">2</span>, shape=(), dtype=int32)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tf.Tensor(<span class="number">4</span>, shape=(), dtype=int32)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tf.Tensor(<span class="number">6</span>, shape=(), dtype=int32)</span><br></pre></td></tr></tbody></table></figure>
<p>ç„¶è€Œï¼Œ<strong>TensorFlow Dataset åŸºæœ¬ä¸Šæ˜¯å›´ç»•é¡ºåºè®¿é—®æ„å»ºçš„</strong>ï¼š<code>tf.data</code> pipeline ä¸­çš„æ¯ä¸€ä¸ªæ“ä½œï¼Œéƒ½ä¼šè¿­ä»£ä»–çš„è¾“å…¥å¹¶ç”Ÿæˆä¸€ä¸ªé¡ºåºçš„è¾“å‡ºæµï¼Œä¾›ä¸‹ä¸€ä¸ªæ“ä½œä½¿ç”¨ã€‚è¿™ä¸ª API ä¸æ”¯æŒéšæœºè®¿é—®ï¼Œå¯¼è‡´åœ¨å°è¯•å®ç°ä¸€äº›å¸¸è§çš„æœºå™¨å­¦ä¹ å·¥ä½œæµæ—¶ä¼šå‡ºç°ä¸€äº›é‡å¤§é—®é¢˜ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">dataset[<span class="number">0</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>TypeError: <span class="string">'TensorSliceDataset'</span> object does <span class="keyword">not</span> support indexing</span><br><span class="line"></span><br><span class="line">list(dataset.as_numpy_iterator())</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br></pre></td></tr></tbody></table></figure>
<h3 id="Data-Shuffling"><a href="#Data-Shuffling" class="headerlink" title="Data Shuffling"></a>Data Shuffling</h3><p>åœ¨è®­ç»ƒä¸€ä¸ªæ·±åº¦å­¦ä¹ æ¨¡å‹æ—¶ï¼Œè®­ç»ƒé›†é€šå¸¸åœ¨è¾“å…¥æ¨¡å‹å‰è¢« shuffleï¼Œè¿™ä¸ªæ“ä½œé€šå¸¸ä¼šæå‡æ³›åŒ–æ€§èƒ½ã€‚å¦‚æœæˆ‘ä»¬çš„æ•°æ® API åªæ”¯æŒé¡ºåºè®¿é—®ï¼Œè¦æ€æ ·å®ç° random shuffling å‘¢ï¼Ÿä¸€ä¸ªç®€å•ä½†æ˜¯ä½æ•ˆçš„æ–¹æ³•æ˜¯å°†å°½å¯èƒ½å¤šçš„æ•°æ®è¯»å…¥å†…å­˜å¹¶åœ¨å†…å­˜é‡Œé¢ shuffleã€‚å®é™…ä¸Šï¼Œè¿™æ­£æ˜¯ <code>tf.data</code> çš„ shuffle çš„åšæ³•ï¼</p>
<blockquote>
<p>This dataset fills a buffer with <code>buffer_size</code> elements, then randomly samples elements from this buffer, replacing the selected elements with new elements. For perfect shuffling, a buffer size greater than or equal to the full size of the dataset is required.</p>
</blockquote>
<p>å¯¹äºä¸èƒ½å®Œå…¨æ”¾å…¥å†…å­˜çš„æ•°æ®é›†ï¼ˆæ·±åº¦å­¦ä¹ ä¸­æœ€å¸¸è§çš„æƒ…å†µï¼‰ï¼Œ<strong><code>shuffle()</code> å®é™…ä¸Šä¸ä¼š shuffle æ•´ä¸ªæ•°æ®é›†</strong>ï¼è¿™æ„å‘³ç€ <code>shuffle()</code> åœ¨å¤§å¤šæ•°åº”ç”¨ç¨‹åºä¸­æ²¡æœ‰è¾¾åˆ°é¢„æœŸçš„æ•ˆæœã€‚åŒ…æ‹¬æˆ‘ä»¬åœ¨å†…çš„å¾ˆå¤šä»ä¸šäººå‘˜éƒ½çŠ¯äº†è¿™ä¸ªé”™è¯¯ï¼Œå¹¶ä¸”çœ‹åˆ°ä»–ä»¬æ¨¡å‹çš„æ³›åŒ–æ€§èƒ½å› æ­¤æ”¶åˆ°å½±å“ã€‚è™½ç„¶å¯ä»¥é€šè¿‡æå‰å°†æ•°æ®è¯»è¿›å†…å­˜æˆ– shuffle æ–‡ä»¶ååˆ—è¡¨æ¥å®ç° shuffle æ•´ä¸ªæ•°æ®é›†ï¼Œä½†æ˜¯å¾ˆå¤šç”¨æˆ·å¯èƒ½æ²¡æœ‰æ„è¯†åˆ°è¿™ä¸ªä»–ä»¬çš„ä»£ç ä¸­å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼</p>
<h3 id="Data-Sharding"><a href="#Data-Sharding" class="headerlink" title="Data Sharding"></a>Data Sharding</h3><p>åœ¨è¿›è¡Œ data-parallel distributed training æ—¶ï¼Œæ¯ä¸€ä¸ª workerï¼ˆé€šå¸¸æ˜¯ GPUï¼‰è¦å¯¹æ¯ä¸ª batch çš„ä¸€ä¸ªéƒ¨åˆ†ï¼ˆæˆ–è€…å« <code>shard</code>ï¼‰è¿›è¡Œè®­ç»ƒã€‚ä¸ºäº†å¤„ç†è¿™ä¸ªå¸¸è§çš„ä»»åŠ¡ï¼Œ<code>tf.data</code> æä¾›äº†ä¸€ä¸ªçœ‹èµ·æ¥å®Œç¾å¥‘åˆæˆ‘ä»¬è¦æ±‚çš„æ–¹æ³•ï¼š<a href="https://www.tensorflow.org/api_docs/python/tf/data/Dataset#shard"><code>shard(n, i)</code></a>å°†æ•°æ®åˆ†ä¸º n ä¸ª shardsï¼Œå¹¶è¿”å›ç¬¬ i ä¸ª shardï¼Œä»¥ä¾¿åœ¨å½“å‰ worker ä¸­ç»§ç»­å¤„ç†ã€‚</p>
<p>ä¸å¹¸çš„æ˜¯ï¼Œè¿™é‡Œå­˜åœ¨ä¸€ä¸ªé™·é˜±ï¼š<code>shard()</code> ä¼šéå†æ•´ä¸ªè¾“å…¥æ•°æ®é›†ï¼Œæ¯æ¬¡è¿”å›ç¬¬ n ä¸ªè®°å½•å¹¶å¿½ç•¥å…¶ä»–è®°å½•ï¼ˆæˆ‘çš„ç†è§£æ˜¯å‡è®¾ n=4ï¼Œè¾“å…¥æ•°æ®ä¼šæŒ‰ 12341234 çš„æ–¹å¼åˆ†å‘ï¼Œä½†æ˜¯æ¯ä¸ª worker éƒ½è¦è¯»å®Œ 1234 æ‰èƒ½é€‰å‡ºç¬¬ n ä¸ªï¼‰ï¼è¿™æ„å‘³ç€å¦‚æœåœ¨åˆ†å¸ƒå¼è®­ç»ƒæ—¶ï¼Œå¯¹æ‰“æ•°æ®é›†åº”ç”¨ <code>shard()</code> æ“ä½œï¼Œæ¯ä¸ª worker åœ¨åˆ†å¸ƒå¼è®­ç»ƒä»»åŠ¡ä¸­æœ€ç»ˆå°†è¯»å–æ•´ä¸ªæ•°æ®é›†ã€‚å¦‚æœä½ æ­£åœ¨ç”¨ 64 å— GPU è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œè¿™æ„å‘³ç€æ¶ˆè€—<strong>æ¯”é¢„æœŸå¤š 64 å€çš„ç£ç›˜ I/O</strong>ã€‚å¦‚æœä½ åœ¨ <code>shard()</code> ä¹‹å‰è¿›è¡ŒåŠ¨æ€ï¼ˆon-the-flyï¼‰æ•°æ®å¢å¼ºï¼Œé‚£ä¹ˆæƒ…å†µä¼šå˜å¾—æ›´ç³Ÿ â€”â€” è¿™äº›æ•°æ®å¢å¼ºæ“ä½œä¼šè¢«æ¯ä¸ª worker å†—ä½™åœ°æ‰§è¡Œã€‚</p>
<p>TensorFlow çš„æ–‡æ¡£æ‰¿è®¤äº†è¿™ä¸€ç‚¹å¹¶æŒ‡å‡ºï¼š</p>
<blockquote>
<p>Generally it is best if the shard operator is used early in the dataset pipeline.<br>é€šå¸¸æ¥è¯´ï¼Œæœ€å¥½åœ¨æ•°æ®é›† pipeline çš„æ—©æœŸä½¿ç”¨ shard æ“ä½œã€‚</p>
</blockquote>
<p>TensorFlow æ¨èçš„æ–¹æ³•æ˜¯åˆ›å»º TFRecord æ–‡ä»¶è®°å½•æ–‡ä»¶åï¼Œå¹¶åœ¨æ–‡ä»¶ååˆ—è¡¨ä¸Šåº”ç”¨ <code>shard()</code>ã€‚æ¯ä¸ª worker æ¥æ”¶å¹¶å¤„ç†ä¸€ç»„ä¸ç›¸äº¤çš„æ–‡ä»¶ï¼Œè¿™æ ·å°±é¿å…äº†ä»»ä½•ä¸å¿…è¦çš„ç£ç›˜ I/Oã€‚è¿™ç§æ–¹æ³•æ˜¯æœ‰æ•ˆçš„ï¼Œä½†å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­ï¼Œä½ è¦å°†æ•°æ®é›†åˆ’åˆ†ä¸ºæ¯” worker æ•°è¿˜è¦å¤šçš„æ–‡ä»¶ã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªå¤§æ•°æ®é›†å­˜åœ¨å°‘æ•°å‡ ä¸ªæ–‡ä»¶ä¸­ï¼Œé‚£ä½ å°±ä¸èµ°è¿äº†ã€‚æ­¤å¤–ï¼Œè¿™äº›æ–‡ä»¶ä¹‹é—´çš„ä»»ä½•å¤§å°ä¸å¹³è¡¡éƒ½ä¼šå¯¼è‡´æ‰é˜Ÿï¼Œä»è€Œå½±å“è®­ç»ƒæ•ˆæœã€‚</li>
<li>æ›´æœ‰å¯èƒ½çš„æ˜¯ï¼Œä½ æ²¡æœ‰æ„è¯†åˆ°è¿™äº›é—®é¢˜ï¼è®¸å¤šå®é™…çš„æ•°æ®åŠ è½½ä»£ç åªæ˜¯å°† Python ç”Ÿæˆå™¨é€šè¿‡ <code>Dataset.from_generator()</code> è½¬æ¢ä¸º TensorFlow Datasetã€‚å½“å¤„ç†å°è§„æ¨¡æ•°æ®æ—¶ï¼Œè¿™æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯éšç€æ•°æ®é›†çš„å¢é•¿ï¼Œå°†å¾ˆå¿«é‡åˆ°ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ã€‚</li>
</ol>
<h3 id="ä¿å­˜å’Œè¿˜åŸè¿­ä»£å™¨çŠ¶æ€"><a href="#ä¿å­˜å’Œè¿˜åŸè¿­ä»£å™¨çŠ¶æ€" class="headerlink" title="ä¿å­˜å’Œè¿˜åŸè¿­ä»£å™¨çŠ¶æ€"></a>ä¿å­˜å’Œè¿˜åŸè¿­ä»£å™¨çŠ¶æ€</h3><p>å¦‚æœä½ å¸Œæœ›æ„å»ºä¸€ä¸ªå¯ä»¥ä»é”™è¯¯ä¸­æ¢å¤çš„æ·±åº¦å­¦ä¹ è®­ç»ƒç³»ç»Ÿï¼Œä¸€ç§å¸¸è§çš„æ–¹æ³•æ˜¯ä½¿ç”¨ checkpoint-restartï¼šå®šæœŸå°†è®­ç»ƒä»»åŠ¡çš„çŠ¶æ€ä¿å­˜åˆ° checkpoint æ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨å‘ç”Ÿæ•…éšœæ—¶ä»æœ€è¿‘çš„ checkpoint ä¸­æ¢å¤ä»»åŠ¡ã€‚è¿™å¯¹äºé‚£äº›å¯ä»¥æŒç»­å‡ ä¸ªå°æ—¶ç”šè‡³å‡ å¤©çš„è®­ç»ƒå·¥ä½œå°¤å…¶é‡è¦ã€‚ä½†æ˜¯ï¼Œä¿å­˜å’Œæ¢å¤è®­ç»ƒéœ€è¦çŸ¥é“å½“å‰è®­ç»ƒé˜¶æ®µåœ¨æ•°æ®é›†ä¸­çš„ä½ç½®ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨ä¸€ä¸ª 100,000 ä¸ªå…ƒç´ çš„æ•°æ®é›†ä¸Šè®­ç»ƒï¼Œæœ€è¿‘çš„ checkpoint æ˜¯åœ¨ç¬¬ 50,000 ä¸ªè®°å½•ä¹‹åæ‰§è¡Œçš„ï¼Œé‚£ä¹ˆä½ éœ€è¦ç¡®ä¿ä»ç¬¬ 50,001 æ¡è®°å½•æ¢å¤ï¼Œè€Œä¸æ˜¯ä»å¤´å¼€å§‹ã€‚å¯¹äºéšæœºè®¿é—®æ¥å£ï¼Œè¿™å¾ˆç®€å•ï¼šåªéœ€è¦å°†ç´¢å¼•ä½ç½®ä¿å­˜ä¸ºæ•´æ•°ï¼Œç„¶åä»ä¸­æ–­çš„åœ°æ–¹æ¢å¤è®­ç»ƒã€‚å¯¹äºé¡ºåºè®¿é—®æ¥å£ï¼Œè¿™å¯èƒ½éå¸¸å›°éš¾ã€‚æ€»æ‰€å‘¨çŸ¥ï¼ŒPython ç”Ÿæˆå™¨å¾ˆéš¾è¢« pickleï¼ˆåºåˆ—åŒ–ï¼‰ã€‚TensorFlow Dataset å®éªŒæ€§åœ°æ”¯æŒ checkpoint å’Œæ¢å¤æŸäº›ç±»å‹çš„æ•°æ®é›†ï¼Œä½†ä¸æ”¯æŒä½¿ç”¨ <code>tf.data.Dataset.from_generator()</code> åˆ›å»ºçš„æ•°æ®é›†ã€‚</p>
<h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>ä¹‹æ‰€ä»¥å­˜åœ¨ä¸Šè¿°é—®é¢˜ï¼Œæ˜¯å› ä¸º <code>tf.data</code> æ˜¯å›´ç»•å¾ªåºå­˜å–æ„å»ºçš„ã€‚æ‰€ä»¥ï¼Œå¸®è‡ªå·±ä¸ªå¿™ï¼šä¸è¦è®©ä½ çš„æ•°æ®è¯»å–ä»£ç å®Œå…¨ä¾èµ–é¡ºåºè®¿é—®æ¨¡å¼ã€‚å¦‚æœä½ åƒä½¿ç”¨é¢„è¯»å–å’Œæ”¯æŒé¡ºåºè¯»å–çš„å‡½æ•°å¼é£æ ¼ï¼Œä½ å¯ä»¥åƒä¸‹é¢è¿™æ ·åŒ…è£…ä¸€ä¸ªéšæœºè¯»å–çš„æ¥å£ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">dataset = RandomAccessDataset()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sequential_access_dataset</span>() -&gt; Iterator:</span></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(len(dataset)):</span><br><span class="line">        <span class="keyword">yield</span> dataset[index]</span><br></pre></td></tr></tbody></table></figure>
<p>ä»éšæœºåˆ°é¡ºåºæ˜¯å¾ˆå®¹æ˜“çš„ï¼Œä½†æ˜¯èµ°å¦ä¸€æ¡è·¯å°±éš¾å¾—å¤šäº†ã€‚</p>
<p>TensorFlow Dataset æ˜¯ç›®å‰æ¨èçš„åœ¨ TensorFlow ä¸­åŠ è½½æ•°æ®çš„æ–¹å¼ï¼Œè€Œä¸”è¿™ç§æ–¹å¼çœ‹èµ·æ¥ä¸€æ®µæ—¶é—´å†…éƒ½ä¸ä¼šæ”¹å˜ã€‚æœ¬æ–‡çš„è®¸å¤šè¯»è€…å¯èƒ½ä¼šå‘ç°è‡ªå·±å¤„äºä¸€ä¸ªä¸å¹¸çš„ä½ç½®ï¼Œç”±äºä¸å¯æ§å› ç´ ï¼Œä»–ä»¬åªèƒ½ä¾èµ– TensorFlow Datasetã€‚å¦‚æœä½ ä¹Ÿæ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨åŠªåŠ›å¯»æ‰¾ä¸€ä¸ªèƒ½è®©ä½ çš„ç”Ÿæ´»æ›´è½»æ¾çš„è§£å†³æ–¹æ¡ˆ â€”â€” ä¸‹å‘¨è¯·ç»§ç»­å…³æ³¨ï¼</p>
]]></content>
      <tags>
        <tag>TensorFlow</tag>
        <tag>Deep Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ GitHub Action è‡ªåŠ¨éƒ¨ç½² Hexo åšå®¢</title>
    <url>/2020/08/02/%E4%BD%BF%E7%94%A8GitHub-Action%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2Hexo%E5%8D%9A%E5%AE%A2/</url>
    <content><![CDATA[<p>åŸºæœ¬æµç¨‹å‚ç…§ <a href="https://github.com/marketplace/actions/hexo-action">https://github.com/marketplace/actions/hexo-action</a></p>
<h2 id="Step-1-ç”Ÿæˆssh-key-pair"><a href="#Step-1-ç”Ÿæˆssh-key-pair" class="headerlink" title="Step 1. ç”Ÿæˆssh key pair"></a>Step 1. ç”Ÿæˆ ssh key pair</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆ ssh key pairã€‚æœ€å¥½æ˜¯ä¸“é—¨ä¸ºè¿™ä¸ªä»“åº“ç”Ÿæˆä¸€ä¸ª pairï¼Œå› ä¸ºåé¢éœ€è¦ä¸Šä¼ ç§é’¥ï¼Œå¦‚æœæ˜¯æœ¬æœºå¸¸ç”¨çš„ ssh key pairï¼Œä¼šå­˜åœ¨ä¸€å®šé£é™©ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">"username@example.com"</span></span><br></pre></td></tr></tbody></table></figure>
<p>é‚®ç®±å¯ä»¥ä¿®æ”¹ä¸ºè‡ªå·±çš„é‚®ç®±ï¼Œè¯¢é—®ä¿å­˜ key çš„æ–‡ä»¶è·¯å¾„æ—¶ï¼Œéšä¾¿å†™ä¸€ä¸ªï¼Œé¿å…è¦†ç›–åŸæœ‰çš„ keyã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"> Â± ssh-keygen -t rsa -C <span class="string">"username@example.com"</span></span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/Users/sundoge/.ssh/id_rsa): hexo</span><br></pre></td></tr></tbody></table></figure>
<p>ä»¥è¾“å…¥ <code>hexo</code> ä¸ºä¾‹ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹å¾—åˆ° <code>hexo</code>ï¼Œ<code>hexo.pub</code> ä¸¤ä¸ªæ–‡ä»¶ï¼Œå‰è€…æ˜¯ç§é’¥ï¼Œåè€…æ˜¯å…¬é’¥ã€‚</p>
<p>å°†å…¬é’¥å¡«å…¥ <code>Settings &gt; Deploy Keys</code>ã€‚å°†ç§é’¥å¡«å…¥ <code>Settings &gt; Secrets</code>ï¼Œé”®åè®¾ä¸º <code>DEPLOY_KEY</code>ã€‚è¿™æ · GitHub Action å°±å¯ä»¥åˆ©ç”¨ <code>DEPLOY_KEY</code> å°†ç”Ÿæˆå¥½çš„é™æ€é¡µé¢ push åˆ°éƒ¨ç½²åˆ†æ”¯ã€‚</p>
<h2 id="Step2-é…ç½®GitHub-Action"><a href="#Step2-é…ç½®GitHub-Action" class="headerlink" title="Step2: é…ç½®GitHub Action"></a>Step2: é…ç½® GitHub Action</h2><p>åˆ›å»º<code>.github/workflows/xxx.yml</code>ï¼Œç”¨ä½ è®¤ä¸ºçš„ workflow åå­—å‘½åã€‚<a href="https://github.com/marketplace/actions/hexo-action">Hexo Action</a> é‡Œé¢ç»™å‡ºäº†è¯¦ç»†çš„è®¾ç½®ï¼Œæˆ‘è¿™é‡Œåªæ”¾æˆ‘è‡ªå·±çš„</p>
<figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Hexo</span> <span class="string">Deploy</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [<span class="string">'dev'</span>]</span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">A</span> <span class="string">job</span> <span class="string">to</span> <span class="string">deploy</span> <span class="string">blog.</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Cache</span> <span class="string">node</span> <span class="string">modules</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">actions/cache@v2</span></span><br><span class="line">      <span class="attr">id:</span> <span class="string">cache</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">node_modules</span></span><br><span class="line">        <span class="attr">key:</span> <span class="string">${{</span> <span class="string">runner.os</span> <span class="string">}}-node-${{</span> <span class="string">hashFiles('**/package-lock.json')</span> <span class="string">}}</span></span><br><span class="line">        <span class="attr">restore-keys:</span> <span class="string">|</span></span><br><span class="line">          <span class="string">${{</span> <span class="string">runner.os</span> <span class="string">}}-node-</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">Dependencies</span></span><br><span class="line">      <span class="attr">if:</span> <span class="string">steps.cache.outputs.cache-hit</span> <span class="type">!=</span> <span class="string">'true'</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">npm</span> <span class="string">ci</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Deploy hexo blog website.</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span></span><br><span class="line">      <span class="attr">id:</span> <span class="string">deploy</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">sma11black/hexo-action@v1.0.2</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">        <span class="attr">deploy_key:</span> <span class="string">${{</span> <span class="string">secrets.DEPLOY_KEY</span> <span class="string">}}</span></span><br><span class="line">    </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Get</span> <span class="string">the</span> <span class="string">output</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line">        <span class="string">echo</span> <span class="string">"$<span class="template-variable">{{ steps.deploy.outputs.notify }}</span>"</span></span><br></pre></td></tr></tbody></table></figure>
<p>é¦–å…ˆæˆ‘æŠŠå†™ä½œåˆ†æ”¯è®¾åœ¨äº† devï¼Œæ‰€ä»¥è§¦å‘æ¡ä»¶æ˜¯ dev branch å­˜åœ¨ push æ“ä½œã€‚ç„¶åæˆ‘ä»¬ä¼šæ£€æŸ¥ <code>node_modules</code> çš„ç¼“å­˜ï¼Œå¦‚æœæ²¡æœ‰ç¼“å­˜å°± <code>npm install</code> å¹¶ç¼“å­˜ã€‚æœ€åæˆ‘ä»¬è°ƒç”¨ <code>sma11black/hexo-action</code>ï¼Œé‡Œé¢æœ¬è´¨ä¸Šå°±æ˜¯å¸®ä½ æ‰§è¡Œäº† <code>hexo deploy</code> çš„æ“ä½œï¼Œè¿™æ ·ç¼–è¯‘å¥½çš„é™æ€é¡µé¢å°±æ¨åˆ° master branch äº†ã€‚</p>
<p>å°è¯•è¿‡å‡ æ¬¡ï¼Œåˆ æ‰å¤šä½™çš„ dependency ä¹‹åï¼ŒGitHub Action æ­£å¸¸è¿ä½œã€‚</p>
<p><img src="https://i.loli.net/2020/07/31/C9HbrLjyUO1X3EQ.png" alt="image.png"></p>
<p>ä¸è¶³çš„åœ°æ–¹åœ¨äºè°ƒç”¨åˆ«äººçš„ actionï¼Œå¯èƒ½æœ‰ä¸€äº›éœ€è¦æ‰‹åŠ¨å®‰è£…çš„ä¾èµ–ç¼ºå¤±ã€‚åç»­è€ƒè™‘ç ”ç©¶ä¸€ä¸‹ GitHub Actionã€‚</p>
]]></content>
      <tags>
        <tag>GitHub Action</tag>
      </tags>
  </entry>
</search>
